<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel</title>
</head>

<body>
    <h2>Burt Coin Admin:</h2>
    <div id="control">
        <button id="banUser">ban User</button>
        <button id="unbanUser">unban User</button>
        <button id="ChangeUserBalance">Change User Balance</button>
        <button id="ChangeUserPassword">Change User Password</button>
        <button id="DeleteUser">Delete User</button>
    </div>
    <table id="userTable">
        <tr>
            <th>Username</th>
            <th>Balance</th>
            <th>Address</th>
            <th>Is Banned</th>
        </tr>
    </table>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.12.1/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.12.1/firebase-analytics.js";
        import { getDatabase, set, ref, get, child, onValue, update, remove } from "https://www.gstatic.com/firebasejs/9.12.1/firebase-database.js"
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries

        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
            apiKey: "AIzaSyBlgCt1yJFfwKguVfymD5s1uB98Y3mcL2U",
            authDomain: "burt-coin.firebaseapp.com",
            projectId: "burt-coin",
            storageBucket: "burt-coin.appspot.com",
            messagingSenderId: "942203765915",
            appId: "1:942203765915:web:ce50f6f18a90216bce723e",
            measurementId: "G-5CD9ZFYH8K"
        };


        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const db = getDatabase(app);
        const dbref = ref(db);
        const userTable = document.getElementById("userTable");
        const banUser = document.getElementById("banUser");
        const unbanUser = document.getElementById("unbanUser");
        const control = document.getElementById("control");
        const ChangeUserBalance = document.getElementById("ChangeUserBalance");
        const ChangeUserPassword = document.getElementById("ChangeUserPassword");
        const DeleteUser = document.getElementById("DeleteUser");
        ChangeUserBalance.onclick = function() {
            let username = prompt("Enter Username");
            let newBalance = prompt("Enter New Balance");
            update(child(dbref, "users/" + username), {
                balance: newBalance
            });
        }
        DeleteUser.onclick = function() {
            let username = prompt("Enter Username");
            remove(child(dbref, "users/" + username));
        }
        ChangeUserPassword.onclick = function() {
            let username = prompt("Enter Username");
            let newPassword = prompt("Enter New Password");
            update(child(dbref, "users/" + username), {
                password: newPassword
            });
        }

        banUser.onclick = function () {
            let username = prompt("Enter Username");
            let userRef = ref(db, "users/" + username);
            update(userRef, {
                banned: true
            });
        }
        unbanUser.onclick = function () {
            let username = prompt("Enter Username");
            let userRef = ref(db, "users/" + username);
            update(userRef, {
                banned: false
            });
        }

        onValue(dbref, (snapshot) => {
            const data = snapshot.val();
            let users = data.users;
            let userKeys = Object.keys(users);
            userTable.innerHTML = "";
            let tableHeader = document.createElement("tr");
            let usernameHeader = document.createElement("th");
            let balanceHeader = document.createElement("th");
            let passwordHeader = document.createElement("th");
            let isBannedHeader = document.createElement("th");
            usernameHeader.innerHTML = "Username";
            balanceHeader.innerHTML = "Balance";
            isBannedHeader.innerHTML = "Is Banned";
            passwordHeader.innerHTML = "Password";
            tableHeader.appendChild(usernameHeader);
            tableHeader.appendChild(balanceHeader);
            tableHeader.appendChild(isBannedHeader);
            tableHeader.appendChild(passwordHeader);

            userTable.appendChild(tableHeader);
            for (let i = 0; i < userKeys.length; i++) {
                let user = users[userKeys[i]];
                let tableRow = document.createElement("tr");
                let username = document.createElement("td");
                let balance = document.createElement("td");
                let password = document.createElement("td");
                let isBanned = document.createElement("td");

                username.innerHTML = userKeys[i];
                balance.innerHTML = user.balance;
                isBanned.innerHTML = user.banned;
                password.innerHTML = user.password;

                tableRow.appendChild(username);
                tableRow.appendChild(balance);
                tableRow.appendChild(isBanned);
                tableRow.appendChild(password);
                userTable.appendChild(tableRow);

            }
        });

    </script>
    <style>
        table {
            font-family: arial, sans-serif;
            border-collapse: collapse;
            width: 100%;
            border: 2px solid green;
        }
        tr {
            text-align: center;
        }
        td, th {
            border: 1px solid #dddddd;
            text-align: left;
            padding: 8px;
        }
        button {
            background-color: green;
            color: white;
            padding: 10px;
            border: none;
            border-radius: 5px;
            margin: 5px;
        }
        button:hover {
            background-color: #4CAF50;
            color: white;
        }
        #control {
            display: flex;
            flex-direction: row;
            justify-content: center;
            align-items: center;
        }
        body {
            text-align: center;
            font-family: Arial, Helvetica, sans-serif;
        }

    </style>
</body>

</html>